<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Free 1080p 4K YouTube Video Downloader - Enhanced</title>
  <meta
    content="Fast and convenient YouTube video downloader by YTDown lets you download YouTube videos in MP4 at various resolutions like 1080p and 4K for free. Enhanced UI and features."
    name="description"
  />
  <link href="https://www.ytdown.vercel.app/" rel="canonical" />
  <link
    href="https://www.YTDown.app/favicon.ico"
    rel="icon"
    type="image/x-icon"
  />
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    :root {
      --bg-primary: #121212;
      --bg-secondary: #1e1e1e;
      --bg-card: rgba(45, 45, 45, 0.7);
      --text-primary: #ffffff;
      --text-secondary: #b3b3b3;
      --accent-color: #e91e63;
      --accent-hover: #c2185b;
      --card-border: rgba(255, 255, 255, 0.08);
      --mica-bg: rgba(30, 30, 30, 0.8);
      --mica-secondary: rgba(45, 45, 45, 0.5);
      --shadow-color: rgba(0, 0, 0, 0.3);
      --error-color: #ff5252;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacMacFont, Roboto, Arial, sans-serif;
      font-size: 1em;
      line-height: 1.6;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      overflow-x: hidden;
      /* Removed redundant role="document" from body */
    }

    h1, h2, h3 {
      color: var(--text-primary);
      font-weight: 600;
      letter-spacing: 0.5px;
      /* Added text-wrap for better heading line breaking on modern browsers */
      text-wrap: balance; 
    }

    p, ul, ol, li {
      color: var(--text-secondary);
    }

    a {
      text-decoration: none;
      color: var(--text-secondary);
      transition: color 0.3s ease;
    }

    a:hover {
      color: var(--text-primary);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Focus visible styles for accessibility */
    *:focus-visible {
        outline: 2px solid var(--accent-color);
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(233, 30, 99, 0.3);
    }
    /* Custom focus styles for input and buttons, ensuring they override default outline */
    .input-container input:focus,
    .input-container button.download-btn:focus,
    .clear-input-btn:focus,
    #backToTopBtn:focus {
        outline: none; /* Custom focus handles this */
        /* Re-apply custom box-shadow for specific elements if they need unique focus styles */
        box-shadow: 0 0 0 2px var(--bg-primary), 0 0 0 4px var(--accent-color); 
    }
    /* Ensure the general focus-visible applies to links and other elements if not specifically overridden */
    header .site-navbar a:focus-visible,
    footer a:focus-visible,
    .faq-item h3:focus-visible {
        outline: 2px solid var(--accent-color);
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(233, 30, 99, 0.3);
    }


    /* Header with glass effect */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      background: var(--mica-bg);
      border-bottom: 1px solid var(--card-border);
      box-shadow: 0 4px 12px var(--shadow-color);
      padding: 15px 0;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    header .site-title a {
      font-size: 1.5em;
      font-weight: 600;
      background: linear-gradient(90deg, var(--accent-color), #7c4dff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }

    header .site-navbar {
      display: flex;
      gap: 20px;
    }

    header .site-navbar a {
      font-size: 1em;
      font-weight: 500;
      color: var(--text-secondary);
      position: relative;
      padding: 5px 0;
    }

    header .site-navbar a:hover,
    header .site-navbar a.active {
      color: var(--text-primary);
    }

    header .site-navbar a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: 0;
      left: 0;
      background: linear-gradient(90deg, var(--accent-color), #7c4dff);
      transition: width 0.3s ease;
    }

    header .site-navbar a:hover::after,
    header .site-navbar a.active::after {
      width: 100%;
    }

    /* Main content area */
    main {
      padding: 40px 0;
    }

    /* Hero section with glassmorphism */
    .downloader-section {
      text-align: center;
      padding: 60px 20px;
      margin-bottom: 40px;
      background: linear-gradient(135deg, rgba(46, 46, 46, 0.4), rgba(25, 25, 25, 0.4));
      border-radius: 16px;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 32px var(--shadow-color);
    }

    .downloader-section h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(90deg, var(--accent-color), #7c4dff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }
    .downloader-section p:first-of-type { /* Target the subtitle */
        font-size: 1.1em;
        color: var(--text-secondary);
        margin-bottom: 20px;
    }

    .input-container {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      align-items: flex-start; /* Align items to start for error message */
      flex-wrap: wrap; /* Allow wrapping for error message */
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      position: relative;
    }

    .input-wrapper {
        display: flex;
        width: 70%; /* Default width */
        position: relative;
        align-items: center;
    }

    .input-container input {
      flex-grow: 1; /* Take remaining space in wrapper */
      height: 56px;
      padding: 15px 45px 15px 20px; /* Add padding-right for clear button */
      font-size: 1em;
      line-height: 1;
      background-color: rgba(255, 255, 255, 0.08);
      color: var(--text-primary);
      border: 2px solid var(--card-border);
      border-right: none;
      border-radius: 28px 0 0 28px;
      outline: none;
      box-shadow: 0 4px 12px var(--shadow-color);
      transition: all 0.3s ease;
    }

    .input-container input:focus {
      background-color: rgba(255, 255, 255, 0.12);
      border-color: var(--accent-color);
      /* Custom focus ring handled by input-container input:focus selector above */
    }

    .clear-input-btn {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: transparent;
        border: none;
        color: var(--text-secondary);
        font-size: 1.2em;
        cursor: pointer;
        padding: 5px;
        display: none; /* Hidden by default */
        z-index: 2;
    }
    .clear-input-btn:hover {
        color: var(--text-primary);
    }
     /* Focus-visible applies to this button as well via the general rule */


    .input-container button.download-btn {
      width: auto;
      height: 56px;
      padding: 15px 25px;
      font-size: 1em;
      font-weight: 600;
      line-height: 1;
      background: linear-gradient(90deg, var(--accent-color), #7c4dff);
      color: white;
      border: none;
      border-radius: 0 28px 28px 0;
      cursor: pointer;
      box-shadow: 0 4px 12px var(--shadow-color);
      transition: all 0.3s ease;
    }

    .input-container button.download-btn:hover {
      box-shadow: 0 6px 16px rgba(233, 30, 99, 0.4);
      transform: translateY(-2px);
    }
    /* Focus for download button handled by input-container button.download-btn:focus selector above */


    .input-error {
        width: 100%;
        text-align: center;
        color: var(--error-color);
        font-size: 0.9em;
        margin-top: 10px;
        display: none; /* Hidden by default */
    }

    .input-shake {
      animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
    }
    @keyframes shake {
      10%, 90% { transform: translateX(-1px); }
      20%, 80% { transform: translateX(2px); }
      30%, 50%, 70% { transform: translateX(-3px); }
      40%, 60% { transform: translateX(3px); }
    }


    /* API Container for results */
    .api-container {
      margin: 2em auto;
      max-width: 800px;
      min-height: 100px;
      background: var(--mica-secondary);
      border-radius: 16px;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 32px var(--shadow-color);
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      padding: 20px; /* Padding for loading animation */
    }

    .api-container iframe {
      width: 100% !important;
      min-height: 300px;
      border: none;
      display: block;
    }

    /* Enhanced Loading Animation */
    .loading-animation {
      color: var(--text-primary);
      font-size: 18px;
      text-align: center;
      padding: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .spinner {
      margin: 0 auto 20px auto;
      width: 70px;
      text-align: center;
    }
    .spinner > div {
      width: 18px;
      height: 18px;
      background-color: var(--accent-color);
      border-radius: 100%;
      display: inline-block;
      animation: sk-bouncedelay 1.4s infinite ease-in-out both;
    }
    .spinner .bounce1 { animation-delay: -0.32s; }
    .spinner .bounce2 { animation-delay: -0.16s; }
    @keyframes sk-bouncedelay {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1.0); }
    }
    .loading-animation p {
        color: var(--text-secondary);
        font-size: 1.1em;
        margin-top: 10px;
    }


    /* Description section */
    .main-description {
      margin: 60px auto;
      max-width: 800px;
      padding: 0 20px;
    }

    .main-description p {
      margin-bottom: 20px;
      font-size: 1.1em;
      line-height: 1.7;
    }

    /* Features section */
    .content-section {
      margin: 80px 0;
    }
    /* Removed specific :focus outline as general focus-visible covers it, or specific elements need their own */
    .content-section[tabindex="-1"]:focus { 
        outline: none; 
    }


    .content-section h2 {
      font-size: 2em;
      text-align: center;
      margin-bottom: 40px;
      background: linear-gradient(90deg, var(--accent-color), #7c4dff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
      padding: 0 20px;
    }

    .feature {
      background: var(--mica-secondary);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-radius: 16px;
      padding: 30px;
      text-align: center;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 24px var(--shadow-color);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .feature:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.4);
    }

    .feature i {
      color: var(--accent-color);
      font-size: 2.5em;
      margin-bottom: 20px;
    }

    .feature h3 {
      font-size: 1.3em;
      margin-bottom: 15px;
    }

    .feature p {
      margin: 0;
      line-height: 1.6;
    }

    /* Steps section */
    .steps-section {
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 20px;
    }

    .step-card {
      margin-bottom: 30px;
      display: flex;
      flex-direction: column;
      background: var(--mica-secondary);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-radius: 16px;
      padding: 30px;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 24px var(--shadow-color);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .step-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.4);
    }

    .step-header {
      margin-bottom: 20px;
      display: flex;
      align-items: center;
    }

    .step-number {
      width: 44px;
      height: 44px;
      margin-right: 20px;
      background: linear-gradient(135deg, var(--accent-color), #7c4dff);
      color: white;
      font-size: 1.3em;
      font-weight: 600;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 5px 15px rgba(233, 30, 99, 0.3);
    }

    .step-header h3 {
      margin: 0;
      font-size: 1.3em;
    }

    .step-card p {
      margin: 0;
      line-height: 1.7;
    }

    /* FAQ section */
    .faq-section {
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 20px;
    }

    .faq-item {
      margin-bottom: 20px;
      background: var(--mica-secondary);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--card-border);
      box-shadow: 0 8px 24px var(--shadow-color);
      transition: transform 0.3s ease, box-shadow 0.3s ease, max-height 0.5s ease-in-out;
    }

    .faq-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.4);
    }

    .faq-item h3 {
      margin: 0;
      padding: 20px 30px;
      font-size: 1.2em;
      position: relative;
      cursor: pointer;
      transition: background-color 0.2s ease;
      /* Ensure h3 is focusable as it's a toggle button */
      tab-index: 0; /* Make it tabbable */
    }
     .faq-item h3:hover {
        background-color: rgba(255,255,255,0.05);
     }

    .faq-item h3::after {
      content: '\f078'; /* FontAwesome chevron-down */
      font-family: 'Font Awesome 6 Free'; /* Ensure correct family for FA6 */
      font-weight: 900;
      position: absolute;
      right: 30px;
      transition: transform 0.3s ease;
    }

    .faq-item h3.active::after {
      transform: rotate(180deg);
    }

    .faq-item p {
      margin: 0;
      padding: 0 30px 20px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease-in-out, padding-bottom 0.5s ease-in-out;
    }

    .faq-item p.active {
      max-height: 500px; /* Adjust as needed for content length */
      padding-bottom: 20px;
    }

    /* Footer */
    footer {
      background: var(--mica-bg);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-top: 1px solid var(--card-border);
      padding: 30px 0;
      text-align: center;
    }

    .footer-credits {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .footer-credits p {
      margin: 0;
      font-size: 0.95em;
    }

    .footer-credits a {
      color: var(--text-secondary);
      margin: 0 10px; /* Adjusted margin */
      transition: color 0.3s ease;
    }

    .footer-credits a:hover {
      color: var(--accent-color);
    }

    /* Glowing accent effect */
    .glow {
      position: fixed; /* Changed to fixed for consistent background effect */
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(233, 30, 99, 0.3), transparent 70%);
      filter: blur(60px);
      z-index: -1;
      opacity: 0.6;
      pointer-events: none;
      transition: transform 0.1s linear; /* Smooth transform for mouse move */
    }

    .glow-1 { top: 10%; left: 10%; }
    .glow-2 { top: 50%; right: 10%; background: radial-gradient(circle, rgba(124, 77, 255, 0.3), transparent 70%); }
    .glow-3 { bottom: 10%; left: 20%; background: radial-gradient(circle, rgba(124, 77, 255, 0.2), transparent 70%); }


    /* Back to Top Button */
    #backToTopBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, var(--accent-color), #7c4dff);
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      z-index: 1000;
      box-shadow: 0 4px 12px var(--shadow-color);
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease, background-color 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
    }
    #backToTopBtn.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }
    #backToTopBtn:hover {
      box-shadow: 0 6px 16px rgba(233, 30, 99, 0.4);
      transform: translateY(-3px) !important; /* Ensure hover transform overrides .show */
    }
    /* Focus for back to top button handled by #backToTopBtn:focus selector above */


    /* Media queries */
    @media(max-width: 768px) {
      .downloader-section {
        padding: 40px 15px;
      }
      .downloader-section h1 { font-size: 1.8em; }

      .input-container {
        flex-direction: column;
        align-items: stretch; /* Stretch items to full width */
      }
      .input-wrapper {
          width: 100%;
          margin-bottom: 10px;
      }
      .input-container input {
        border-radius: 28px; /* Full radius on mobile */
        border-right: 2px solid var(--card-border); /* Add back border right */
      }
      .input-container button.download-btn {
        width: 100%;
        border-radius: 28px; /* Full radius on mobile */
        margin-bottom: 10px;
      }

      .feature { padding: 20px; }
      .feature i { font-size: 2em; }
      .feature h3 { font-size: 1.2em; }
      .step-card { padding: 20px; }
      .step-header h3 { font-size: 1.2em; }
      .step-number { width: 38px; height: 38px; font-size: 1.1em; }
      .content-section h2 { font-size: 1.7em; }

      /* For a full solution, a hamburger menu would be added here */
      header .site-navbar { display: none; } /* Basic mobile: hide nav or implement burger */
    }
  </style>
</head>
<body>
  <!-- Decorative glowing backgrounds -->
  <div class="glow glow-1"></div>
  <div class="glow glow-2"></div>
  <div class="glow glow-3"></div>

  <header role="banner">
    <div class="header-container">
      <div class="site-title">
        <a href="/" title="Go to homepage">ytdown.app</a>
      </div>
      <nav class="site-navbar" aria-label="Main navigation">
        <a href="#how-to-use" title="Learn how to use YTDown">How to use</a>
        <a href="#features" title="Discover YTDown features">Features</a>
        <a href="#faq" title="Frequently asked questions about YTDown">FAQ</a>
      </nav>
    </div>
  </header>

  <main role="main">
    <div class="container">
      <section class="downloader-section" aria-labelledby="downloader-heading">
        <h1 id="downloader-heading">YouTube Video Downloader</h1>
        <p>High quality video downloads up to 4K resolution for free</p>
        <div class="input-container">
          <div class="input-wrapper">
            <input
              id="videoLinkInput"
              placeholder="Paste YouTube video link here"
              type="url"
              aria-label="YouTube video link"
              aria-describedby="inputErrorMsg"
            />
            <button type="button" id="clearInputBtn" class="clear-input-btn" aria-label="Clear input field" title="Clear input">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <button onclick="convertVideo()" class="download-btn" aria-label="Download or process video link">Download</button>
          <div id="inputErrorMsg" class="input-error" role="alert" aria-live="assertive"></div>
        </div>
      </section>

      <section class="api-container" id="apiContainer" aria-live="polite">
        <!-- Iframe or loading animation will be injected here -->
      </section>

      <section class="content-section main-description" aria-label="About YTDown">
        <p>
          YTDown is an online YouTube downloader that makes saving videos or
          extracting audio simple and convenient. It supports various formats,
          including MP4 for videos up to 4K resolution and MP3 for audio,
          allowing you to enjoy high-quality downloads.
        </p>
        <p>
          We know you want a simple and reliable way to download your videos,
          and that's why we built this easy-to-use tool for you. Whether you
          want to save videos for offline viewing or extract audio for
          listening, it provides an effortless solution.
        </p>
        <p>
          You can choose your preferred format to ensure the best video quality
          or clear sound, and it doesn't require software installation or
          account registration. It's free to use and runs smoothly on all
          devices, whether you're on a laptop, smartphone, or tablet.
        </p>
      </section>

      <section class="content-section" id="features" aria-labelledby="features-heading" tabindex="-1">
        <h2 id="features-heading">Features</h2>
        <div class="features">
          <div class="feature">
            <i class="fas fa-download" aria-hidden="true"></i>
            <h3>Faster Downloads</h3>
            <p>
              Download your videos quickly and safely. Our video downloader
              provides fast downloads so you can get your videos instantly
              whenever you want.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-user-friends" aria-hidden="true"></i>
            <h3>User-Friendly Interface</h3>
            <p>
              Whether you're tech-savvy or not, our minimalist design makes
              downloading videos easy, allowing you to get your videos in just a
              few clicks.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-highlighter" aria-hidden="true"></i>
            <h3>High-Quality Downloads</h3>
            <p>
              It lets you download videos in the same quality as the original,
              including 1080p, 2K, 4K, and more, ensuring clear visuals and
              crisp details.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-video" aria-hidden="true"></i>
            <h3>Versatile Format Options</h3>
            <p>
              It lets you download videos in multiple formats like MP4, MP3,
              WAV, and more, so you can pick the one that works best for your
              device.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-desktop" aria-hidden="true"></i>
            <h3>Cross-Platform Support</h3>
            <p>
              Whether you are using Android, iPhone, Windows, macOS, or Linux,
              you just need a web browser to easily download your favorite
              videos.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-user-check" aria-hidden="true"></i>
            <h3>No Registration Required</h3>
            <p>
              No sign-up required. It lets you download videos instantly. Visit
              the website and start downloading your videos, no account
              required.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-globe" aria-hidden="true"></i>
            <h3>Multi-Service Support</h3>
            <p>
              It's not just for YouTube, but it also allows you to download
              content from Facebook, Twitter, TikTok, Twitch, SoundCloud, Vimeo,
              and more.
            </p>
          </div>
          <div class="feature">
            <i class="fas fa-hand-holding-usd" aria-hidden="true"></i>
            <h3>Free and Easy to Use</h3>
            <p>
              It makes it easy to download your videos for free. No hidden fees
              or subscriptions, just a simple and easy way to download your
              videos.
            </p>
          </div>
        </div>
      </section>

      <section class="content-section steps-section" id="how-to-use" aria-labelledby="how-to-use-heading" tabindex="-1">
        <h2 id="how-to-use-heading">How to Download YouTube Videos with YTDown?</h2>
        <div class="step-card">
          <div class="step-header">
            <div class="step-number" aria-hidden="true">1</div>
            <h3>Paste the YouTube Video Link</h3>
          </div>
          <p>
            Copy the video link from YouTube and paste it into the designated
            input field on YTDown. Then, click the first "Download" button. This
            will retrieve the video card with details such as title, thumbnail,
            format options, and a button.
          </p>
        </div>
        <div class="step-card">
          <div class="step-header">
            <div class="step-number" aria-hidden="true">2</div>
            <h3>Select the Format and Start Converting</h3>
          </div>
          <p>
            Once the video card appears, select your preferred format from the
            drop-down menu, such as MP4 (1080p) for video or MP3 for audio.
            Then, click the second "Download" button to start converting the
            video.
          </p>
        </div>
        <div class="step-card">
          <div class="step-header">
            <div class="step-number" aria-hidden="true">3</div>
            <h3>Download Your YouTube Video</h3>
          </div>
          <p>
            Once the video conversion is complete, the second "Download" button
            will be replaced by the final "Download" button. Click it to save
            the video file to your device and enjoy it offline at your
            convenience.
          </p>
        </div>
      </section>

      <section class="content-section faq-section" id="faq" aria-labelledby="faq-heading" tabindex="-1">
        <h2 id="faq-heading">Frequently Asked Questions</h2>
        <div class="faq-list">
          <!-- FAQ items will be dynamically loaded here by JS -->
        </div>
      </section>
    </div>
  </main>

  <footer role="contentinfo">
    <div class="footer-credits">
      <p>
        © <span id="year"></span>
        <a href="/" title="Go to homepage">YTDown.app</a>
        <a href="/terms-of-service" title="Read our Terms of Service">Terms of Service</a>
        <a href="/privacy-policy" title="Read our Privacy Policy">Privacy Policy</a>
      </p>
    </div>
  </footer>

  <button id="backToTopBtn" title="Go to top" aria-label="Back to top">
    <i class="fas fa-arrow-up" aria-hidden="true"></i>
  </button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.2/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/4.3.9/iframeResizer.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Update current year
      document.getElementById("year").textContent = new Date().getFullYear();

      // FAQ Toggle functionality
      const faqItemsData = [
        { q: "Can I download unlimited videos?", a: "Yes, you can download unlimited videos. There are no restrictions on the number of videos you can save for offline viewing." },
        { q: "Can I download videos in 4K resolution?", a: "Yes, you can download videos in stunning 4K resolution for a crisp and ultra-high-definition (UHD) viewing experience." },
        { q: "Can I convert videos to audio files?", a: "Yes, you can. Our tool allows you to convert your video to multiple audio formats, including MP3, FLAC, WAV, and more." },
        { q: "Is YTDown safe to use?", a: "Yes, YTDown is completely safe to use. It's a web-based tool that doesn't require any software installation, eliminating the risk of malware or viruses. We don't store your personal information or downloaded content on our servers." },
        { q: "Does YTDown work on mobile devices?", a: "Absolutely! YTDown works perfectly on both Android and iOS devices. You can use it on any device with a web browser, including smartphones, tablets, laptops, and desktop computers." }
      ];

      const faqList = document.querySelector('.faq-list');
      faqItemsData.forEach((itemData, index) => {
        const faqItem = document.createElement('div');
        faqItem.className = 'faq-item';

        const faqQuestion = document.createElement('h3');
        faqQuestion.textContent = itemData.q;
        faqQuestion.setAttribute('aria-expanded', 'false');
        faqQuestion.setAttribute('aria-controls', `faq-answer-${index}`);
        faqQuestion.setAttribute('id', `faq-question-${index}`);
        // Make the h3 tag keyboard focusable for accessibility
        faqQuestion.setAttribute('tabindex', '0'); 

        const faqAnswer = document.createElement('p');
        faqAnswer.textContent = itemData.a;
        faqAnswer.setAttribute('id', `faq-answer-${index}`);
        faqAnswer.setAttribute('role', 'region');
        faqAnswer.setAttribute('aria-labelledby', `faq-question-${index}`);
        // Initially hide the answer for screen readers
        faqAnswer.setAttribute('hidden', 'true'); 

        faqItem.appendChild(faqQuestion);
        faqItem.appendChild(faqAnswer);
        faqList.appendChild(faqItem);

        // Toggle function for FAQ
        const toggleFaq = () => {
            const isCurrentlyActive = faqQuestion.classList.contains('active');
            
            // Close all other FAQ items
            faqList.querySelectorAll('.faq-item h3').forEach(otherToggle => {
                if (otherToggle !== faqQuestion) {
                    otherToggle.classList.remove('active');
                    otherToggle.setAttribute('aria-expanded', 'false');
                    otherToggle.nextElementSibling.classList.remove('active');
                    otherToggle.nextElementSibling.setAttribute('hidden', 'true'); // Hide content
                }
            });

            // Toggle current item
            if (isCurrentlyActive) {
                faqQuestion.classList.remove('active');
                faqQuestion.setAttribute('aria-expanded', 'false');
                faqAnswer.classList.remove('active');
                faqAnswer.setAttribute('hidden', 'true'); // Hide content
            } else {
                faqQuestion.classList.add('active');
                faqQuestion.setAttribute('aria-expanded', 'true');
                faqAnswer.classList.add('active');
                faqAnswer.removeAttribute('hidden'); // Show content
            }
        };

        faqQuestion.addEventListener('click', toggleFaq);
        // Add keyboard support for Space and Enter keys
        faqQuestion.addEventListener('keydown', (event) => {
            if (event.key === ' ' || event.key === 'Enter') {
                event.preventDefault(); // Prevent default scroll for spacebar
                toggleFaq();
            }
        });
      });


      // Input field clear button and error handling
      const videoLinkInput = document.getElementById("videoLinkInput");
      const clearInputBtn = document.getElementById("clearInputBtn");
      const inputErrorMsg = document.getElementById("inputErrorMsg");

      videoLinkInput.addEventListener('input', () => {
        clearInputBtn.style.display = videoLinkInput.value ? 'flex' : 'none'; // use flex for icon centering
        if (videoLinkInput.value) {
          inputErrorMsg.style.display = 'none'; // Hide error when user types
          videoLinkInput.classList.remove('input-shake'); // Remove shake if user types
        }
      });

      clearInputBtn.addEventListener('click', () => {
        videoLinkInput.value = '';
        clearInputBtn.style.display = 'none';
        inputErrorMsg.style.display = 'none';
        videoLinkInput.classList.remove('input-shake');
        videoLinkInput.focus();
      });

      // Back to Top Button
      const backToTopBtn = document.getElementById('backToTopBtn');
      // Debounce function for scroll events
      const debounce = (func, delay) => {
        let timeout;
        return function(...args) {
          const context = this;
          clearTimeout(timeout);
          timeout = setTimeout(() => func.apply(context, args), delay);
        };
      };

      const handleScroll = () => {
        if (window.pageYOffset > 300) {
          backToTopBtn.classList.add('show');
        } else {
          backToTopBtn.classList.remove('show');
        }

        // ScrollSpy logic moved here for debounced execution
        let currentSectionId = '';
        sections.forEach(section => {
          const sectionTop = section.offsetTop - headerHeight - 50; 
          // Check if the section is in view, allowing for a slight offset
          if (pageYOffset >= sectionTop && pageYOffset < sectionTop + section.offsetHeight) {
            currentSectionId = section.getAttribute('id');
          }
        });

        navLinks.forEach(link => {
          link.classList.remove('active');
          link.removeAttribute('aria-current'); // Remove aria-current from non-active links
          const href = link.getAttribute('href');
          if (href && href.substring(1) === currentSectionId) {
            link.classList.add('active');
            link.setAttribute('aria-current', 'page'); // Indicate current page
          }
        });

        // Update URL hash without page jump for current section
        if (currentSectionId && window.location.hash !== '#' + currentSectionId) {
            // Check if current hash is not the active section's id
            history.replaceState(null, null, '#' + currentSectionId);
        } else if (!currentSectionId && window.location.hash !== '') {
            // Clear hash if no section is active (e.g., at the very top)
            history.replaceState(null, null, window.location.pathname);
        }
      };

      window.addEventListener('scroll', debounce(handleScroll, 100)); // Debounce scroll event

      backToTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
        // After scrolling to top, clear hash if any
        history.replaceState(null, null, window.location.pathname + window.location.search);
      });

      // ScrollSpy for Navbar
      const sections = document.querySelectorAll('main section[id][aria-labelledby]'); 
      const navLinks = document.querySelectorAll('header .site-navbar a');
      const headerHeight = document.querySelector('header').offsetHeight;

      // Handle navigation clicks to scroll and focus
      navLinks.forEach(link => {
        link.addEventListener('click', (event) => {
          event.preventDefault();
          const targetId = link.getAttribute('href').substring(1);
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            const offsetTop = targetSection.offsetTop - headerHeight - 20; // Adjust scroll position
            window.scrollTo({
              top: offsetTop,
              behavior: 'smooth'
            });
            // Update URL hash
            history.pushState(null, null, '#' + targetId);
            // After scroll, ensure the section is focused for accessibility
            // A small delay ensures the scroll is complete before focusing
            setTimeout(() => {
                targetSection.focus();
            }, 500); 
          }
        });
      });
      
      // Create interactive floating glow effect that follows mouse position
      const glows = document.querySelectorAll('.glow');
      document.addEventListener('mousemove', function(e) {
        const mouseX = e.clientX;
        const mouseY = e.clientY;
        
        glows.forEach((glow, index) => {
          // Adjust sensitivity based on index to create a layered parallax effect
          const moveX = (mouseX - window.innerWidth / 2) / (30 + index * 15); 
          const moveY = (mouseY - window.innerHeight / 2) / (30 + index * 15);
          glow.style.transform = `translate(${moveX}px, ${moveY}px)`;
        });
      });

    }); // End DOMContentLoaded

    // Video conversion function (Global scope as it's called by onclick)
    function convertVideo() {
      const videoLinkInput = document.getElementById("videoLinkInput");
      const videoURL = videoLinkInput.value.trim();
      const inputErrorMsg = document.getElementById("inputErrorMsg");
      
      if (videoURL === "") {
        inputErrorMsg.textContent = "Please paste a YouTube video link first.";
        inputErrorMsg.style.display = 'block';
        videoLinkInput.classList.add('input-shake');
        setTimeout(() => videoLinkInput.classList.remove('input-shake'), 500);
        videoLinkInput.focus();
        return;
      }
      // Basic URL validation (very simple)
      try {
        new URL(videoURL); // Check if it's a valid URL structure
        // No strict YouTube check here to allow "Multi-Service Support" as stated in features
      } catch (_) {
        inputErrorMsg.textContent = "Please enter a valid video URL.";
        inputErrorMsg.style.display = 'block';
        videoLinkInput.classList.add('input-shake');
        setTimeout(() => videoLinkInput.classList.remove('input-shake'), 500);
        videoLinkInput.focus();
        return;
      }
      inputErrorMsg.style.display = 'none'; // Clear error on successful start
      
      const apiContainer = document.getElementById("apiContainer");
      apiContainer.innerHTML = `
        <div class="loading-animation">
          <div class="spinner">
            <div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div>
          </div>
          <p>Processing your request, please hang tight...</p>
        </div>`;
      
      // Ensure iframe resizer is available or wait for it
      const createIframe = () => {
          // Original obfuscated URLs - for demonstration, actual implementation depends on server-side
          // NOTE: Client-side obfuscation (atob) offers no real security.
          const encodedAPIURL = "aHR0cHM6Ly9wLm9jZWFuc2F2ZXIuaW4vYXBpL2NhcmQyLz91cmw9"; // API endpoint
          const apiURL = atob(encodedAPIURL); 
          
          const iframe = document.createElement("iframe");
          iframe.setAttribute("class", "api-iframe");
          iframe.setAttribute("scrolling", "no");
          iframe.setAttribute("allowtransparency", "true");
          iframe.setAttribute("style", "border:none; width:100%; min-height:300px; display:block;"); 
          iframe.setAttribute("src", apiURL + encodeURIComponent(videoURL));
          iframe.setAttribute("title", "Video Download Options"); 
          iframe.setAttribute("rel", "noopener noreferrer"); 
          iframe.setAttribute("sandbox", "allow-scripts allow-same-origin allow-popups allow-forms"); // Added sandbox for security, adjust as needed by API

          apiContainer.innerHTML = ''; // Clear loading animation
          apiContainer.appendChild(iframe);
          
          const headerOffset = document.querySelector('header').offsetHeight;
          const scrollTarget = apiContainer.getBoundingClientRect().top + window.scrollY - (headerOffset + 20);
          window.scrollTo({ top: scrollTarget, behavior: "smooth" });
          
          // Initialize iframe-resizer
          if (typeof iFrameResize !== "undefined") {
            // Delay iframeResize initialization slightly to ensure iframe is fully rendered
            setTimeout(() => {
                iFrameResize({ log: false, checkOrigin: false }, ".api-iframe"); 
            }, 100);
          } else {
            console.warn("iFrameResize not loaded. Iframe might not resize correctly.");
          }
      };

      // Small delay to ensure DOM update for loading animation before iframe creation
      setTimeout(createIframe, 100);
    }
  </script>
</body>
</html>
